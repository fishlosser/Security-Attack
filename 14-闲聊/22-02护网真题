以往的HW工作都干些什么？
我所在的现场，根据甲方需求，分为 4 组：监控组、应急组、处置组、溯源反制组
1、监测组监测设备，整理报警信息，提交交处置单给防守应急组 ；
2、防守应急拿到处置单，进行排查，该组没有看机器的权限，只能和处置组建群沟通，根据处置单（期间要不停的去检测组设备上看详细信息），提出处置建议，让处置组来操作；
3、处置组，主要是甲方的业务人员，因为很多对应急的操作不是很熟悉，而且有些系统他们还需要找系统服务商进行操作，这就增加了沟通的成本；
4、溯源反制组，根据确定的攻击进行溯源和反制，前两天真实攻击较少所以一个处置单 ，基本消耗在不停的找人的路上，一个处置单最初只有建群的时候只有 3 个人，中间遇到不停的问题不停的加人入群，有负责 VPN  的、系统业务开发公司的、甲方维护的、系统管理的....就这样不停的加，直接一个处置单群，加了 20  多个人。
每天的服务器流量告警，只有一些寻常的弱口令异常流量和一些简单的 sql 注入，端口扫描事件，我们只需整改弱口令，封禁发起 sql 注入和端口扫描的 ip 即可
防守日常就是看流量、分析流量，其中大部分都为扫描器流量，由于一般扫描器都会部署在 VPS 上，因此我们可以结合流量监测平台反向扫描。
* 第一步，安全感知平台查看事件预警，分析预警是否误报，
误报，忽略；非误报，进行分析
* 第二步，从安全按感知平台，安全设备，对攻击事件进行分析，
不成功，封禁 IP；成功，开启应急响应排查流程
* 第三步，应急响应，Webshell（网站失陷），
排查 webshell，并且通过安全平台日志分析漏洞，进行下线或修补漏洞，服务器失陷，应急

攻击类别识别方法有哪些？
1、识别攻击源 IP**
在护网期间，很多局点扫描探测类日志占所有攻击日志（IPS）的 90% 以上，此类日志主要来源于自研 / 开源全网扫描器、僵尸网络发起的自动化感染传播。
而在攻防演练实战中，攻击者通常采用搜索引擎对目标进行资产收集。在找到资产的网络区间后，细心的攻击方会对 C 段进行全端口扫描，通过连续的端口扫描日志或者 NMAP 指纹信息日志，通常能判定出攻击者针对性的网络探测行为，很可能是演练攻击方。
有的攻击方在探测目标时，会使用自研的扫描器进行主动扫描，或者通过代理转发至 XRay、W13SCA 扫描器进行被动扫描。这种扫描会在短时间内出现一个源 IP 对一个目标服务器大量的 SQL 注入、XSS 等常规的  WEB 漏洞等攻击日志，这种情况基本也能判定为攻击方行为。
这类扫描类日志，特点是日志量特别大，攻击源 IP 相对固定，攻击持续时间短或长或短，扫描产生的日志类型较多。值得注意的是，很多客户网络是部署有负载均衡和反向代理设备的，需要获取到日志的真实源 IP 才能进行针对性的防护，切忌直接封堵，以免影响业务。
2、手工试探类
在高水准的对抗和演练中，攻击方通常不会进行盲目的扫描。在找到目标资产后，他们会进行谨慎的手工尝试，这类尝试性的日志，很容易被大量的扫描日志所淹没。因此，对于某些提示攻击方意图的告警日志，也需要进行重点处理。
比如攻击方找到上传点，会进行手工上传测试，找到疑似 Struts2，ThinkPHP 框架的系统，会用开源工具或者带编码绕过的自研工具进行尝试，在登录框进行 SQL 手工尝试，或者用 Shiro  反序列化工具尝试等。这些攻击流量产生的日志数量极少，却不能被防守方轻易忽略，可以针对最近一年或近年爆出的漏洞、以及客户资产情况，进行有针对性的日志搜索，一旦发现，可以进行封堵或加固，同时顺藤摸瓜，或去态势感知等平台上进行上下文关联，进一步判断攻击是否成功、摸出攻击者意图。

怎么做攻击研判的？
网络安全中的攻击研判，可以理解为人工层面对攻击事件进行再分析的行为。
一般来说，对攻击事件的分析研判通常从以下 4 个维度进行：
1. 对已发现攻击的来源进行研判；
2. 综合分析攻击技术、工具和路径，判断其威胁性大小；
3. 攻击意图研判；
4. 处置方式判断。
攻击研判，可以看作安全防护流程最为关键的一环。它上承安全告警的分析，下接安全处置的实施，是安全防护过程中技术含量最高的一步。
* 攻击研判的 6 个步骤
攻击研判属于安全事件响应的一部分，为了更好地了解攻击研判在整个事件响应过程中的作用，我们可以把列出包括攻击研判在内的事件响应全流程，其中蓝色部分属于攻击研判的流程部分。

1. 攻击告警真实性研判
在接到告警研判服务请求后，通过内置的研判溯源模型并结合实际环境，快速分析告警主机的进程和操作审计事件，确认告警的真假以及攻击者还做了其他哪些操作，明确告警主机是不是已被入侵，进行系统性的梳理并给出详细的研判分析报告。
在系统发出警报后好做出响应的处置以前，需要对警报进行确认，是误报，还是真的有告警事件发生？如果告警是真实的，那么攻击者是正在试图入侵的过程中，还是已经成功入侵？只有确认告警事件为攻击者已经成功入侵后，才会启动响应处置。
告警研判的结果和对应措施也可以用下表直观地展示出来：

2. 攻击事件调查
一旦确定了告警的真实性，要通过主机、流量侧的日志以及系统告警等信息，对攻击事件进行调查。并根据攻击行为特征建立一套通用的方法论，生成《XXX 事件调查报告》。根据这套方法论在自己的安全设备中添加检测规则，以便在下次面对相同攻击的时候快速做出响应。
在这个过程中，请参阅以下关键问题以全面了解攻击事件：
・最初的攻击媒介是什么？（即，攻击方如何获得对网络的初始访问权限？）
・攻击方如何访问环境？
・攻击方是否利用漏洞来获得访问权或特权？
・攻击方如何维持指挥和控制？
・攻击方在网络或设备上是否有持久性？
・持久性的方法是什么（例如，恶意软件后门、webshell、合法凭证、远程工具等）？
・哪些帐户已被盗用，这些账户是什么权限级别（例如，域管理员、本地管理员、用户帐户等）？
・使用什么方法进行侦察？
・是否发生横向移动？如何进行横向移动（例如，RDP、网络共享、恶意软件等）？
・数据是否被泄露，如果有，是什么类型的，通过什么机制？
3. 失陷范围排查
安全事件发生时，对于横向移动主机，首先会根据现有信息找出一台确认失陷的主机，然后以这台失陷主机的数据以及它的互联关系为线索，在用户系统中展开内网溯源，确认是否存在被横向渗透的主机，并循环此过程逐步找出所有失陷主机，确认攻击影响面及具体的失陷范围。

4. 攻击过程还原
攻击溯源是事件响应的关键，也是安全能力提升的关键。通过对被攻击资产的分析与溯源，还原攻击路径与攻击手法，用户不仅能够有效提升攻防演练效果，还可增强常态化安全防御能力，将攻击事件转换为防御势能，避免二次攻击事件的发生。
5. 防守方成果报告整理
在攻防演练中，防守方在完成攻击确认到调查、还原的整个流程之后，需要整理出一份防守报告，阐述攻击的真实性、攻击的覆盖范围、攻击者的攻击路径及行为。并将报告提交给组织方，即可得分。
6. 攻击清除处置建议
最后，根据对攻击者所用技术和攻击路径的反向梳理结果，安全团队要综合分析对方的攻击动机和意图，以及用户自身的防护水平及目的，给出合理的处置建议。
以上 6 个步骤是在攻防演练或日常防护中所要实施的攻击研判流程，不同企业的攻击研判服务都大致如此。但虽然流程基本一致，不同企业组织的攻击研判质量却参差不齐，究其原因，在于研判模式的区别。
